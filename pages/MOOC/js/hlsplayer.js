var lssPlayerLoad=false;var hlsPlayerLoad=false;var AODIANPLAY_UUID_BASE=0;var _startTime=(new Date).getTime();var systemPlayer;function mpsPlayer(o){var e,a,d,c,h,p,r;var o=o;var u=this;systemPlayer=this;var f=o.hlsUrl;var v=o.url;var y=0;if(!o.container||o.container==""){console.log("缺少必要的参数：container");return}var n=document.getElementById(o.container);if(!n){console.log("container不存在");return}if(!o.uin||!o.appId){console.log("uin或者appId不存在");return}o.globalversion="1.0.1.6.20180329";var l=navigator.userAgent;var t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];var m=true;for(var s=0;s<t.length;s++){if(l.indexOf(t[s])>0){m=false;break}}o.isPc=m;var i=$.ajax({type:"GET",url:"http://privateapi.aodianyun.com/v1/MPS.GetVodAppConfig",data:{uin:o.uin,appId:o.appId},async:false,cache:false,dataType:"jsonp",success:function(e){if(e.Flag==100){if(e.Config.domainIframe){if(e.Config.domainIframe==1){if(top!=self){location.href="about:blank";return}}}for(var a in e.Config){o[a]=e.Config[a]}++AODIANPLAY_UUID_BASE;var r="<div id='aodianplayer_uid_base"+AODIANPLAY_UUID_BASE+"'></div>";var n="#"+o.container;$(n).append(r);o.mediaid="aodianplayer_uid_base"+AODIANPLAY_UUID_BASE;if(o.model==1){if(v)o.hlsUrl=v;else if(f)o.hlsUrl=f}if(m){var l=o.hlsUrl.length;var t=o.hlsUrl.substring(l-3,l);if(t=="mp4"){var s="mp4player";d=s+"Run";c=setInterval(function(){if(hlsPlayerLoad==true){if(d in window){hlsPlayerLoad=false;mp4playerRun.call(u,o);clearInterval(c);return}return}var e="http://cdn.aodianyun.com/mps_v4/mp4player.js?v=0713shffhwjehfuyjs";var a=document.createElement("script");a.type="text/javascript";a.charset="UTF-8";a.src=e;document.getElementsByTagName("body")[0].appendChild(a);hlsPlayerLoad=true;if(d&&d in window){hlsPlayerLoad=false;clearInterval(c);mp4playerRun.call(u,o)}},100)}else{if(o.hlsUrl&&o.hlsUrl!=""){var i=flashChecker();if(o.enablehtml5&&!y){load_script("http://cdn.aodianyun.com/mps/v1/hls.js",function(){var e="hls_player";h=e+"Run";var r=this;p=setInterval(function(){if(hlsPlayerLoad==true){if(h in window){hlsPlayerLoad=false;hls_playerRun.call(r,o);clearInterval(p);return}return}var e="http://cdn.aodianyun.com/mps_v4/h5_hls_player.js?v=bbbnsdjshweyweyu";var a=document.createElement("script");a.type="text/javascript";a.charset="UTF-8";a.src=e;document.getElementsByTagName("body")[0].appendChild(a);hlsPlayerLoad=true;if(h&&h in window){hlsPlayerLoad=false;clearInterval(p);hls_playerRun.call(r,o)}},100)})}else{if(i.f){var s="hlsplayer";d=s+"Run";c=setInterval(function(){if(hlsPlayerLoad==true){if(d in window){hlsPlayerLoad=false;hlsplayerRun.call(u,o);clearInterval(c);return}return}var a="http://cdn.aodianyun.com/mps_v22/hlsplayer.js?v=shdjhsj39232323/1.1.7.1.20180202112000";var e=document.createElement("script");e.type="text/javascript";e.charset="UTF-8";e.src=a;document.getElementsByTagName("body")[0].appendChild(e);e.onload=e.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){e.onload=e.onreadystatechange=null}};e.onerror=function(e){g("hls",a,"loadfail")};hlsPlayerLoad=true;if(d&&d in window){hlsPlayerLoad=false;clearInterval(c);hlsplayerRun.call(u,o)}},100)}else{load_script("http://cdn.aodianyun.com/mps/v1/hls.js",function(){var e="hls_player";h=e+"Run";var r=this;p=setInterval(function(){if(hlsPlayerLoad==true){if(h in window){hlsPlayerLoad=false;hls_playerRun.call(r,o);clearInterval(p);return}return}var e="http://cdn.aodianyun.com/mps_v4/h5_hls_player.js?v=qww123shsfhjfhsf";var a=document.createElement("script");a.type="text/javascript";a.charset="UTF-8";a.src=e;document.getElementsByTagName("body")[0].appendChild(a);hlsPlayerLoad=true;if(h&&h in window){hlsPlayerLoad=false;clearInterval(p);hls_playerRun.call(r,o)}},100)})}}}else document.getElementById(o.container).innerHTML+="hlsUrl地址未传递"}}else{if(o.hlsUrl&&o.hlsUrl!=""){var s="html5player";h=s+"Run";p=setInterval(function(){if(hlsPlayerLoad==true){if(h in window){hlsPlayerLoad=false;html5playerRun.call(u,o);clearInterval(p);return}return}var a="http://cdn.aodianyun.com/mps_v39/html5player.js?v=shdjhsj39232323/1.1.7.5.20180329";var e=document.createElement("script");e.type="text/javascript";e.charset="UTF-8";e.src=a;document.getElementsByTagName("body")[0].appendChild(e);e.onload=e.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){e.onload=e.onreadystatechange=null}};e.onerror=function(e){g("hls",a,"loadfail")};hlsPlayerLoad=true;if(h&&h in window){hlsPlayerLoad=false;clearInterval(p);html5playerRun.call(u,o)}},100)}else{document.getElementById(o.container).innerHTML+="hlsUrl地址未传递"}}}else{console.log(e);return}}});var g=function(e,a,r){if(o.hlsUrl.indexOf("m3u8")!=0){var n=o.hlsUrl.indexOf("//");n=o.hlsUrl.substring(n+2,o.hlsUrl.length);n=n.substring(n.indexOf("/")+1,n.length);o.lssApp=n.substring(0,n.indexOf("/"));o.lssStream=n.substring(n.indexOf("/")+1,n.indexOf("."))}var l={};l.App=o.lssApp;l.Stream=o.lssStream;l.PlayDomainName=o.rtmpDomain;l.MPSId=o.appId;l.PlayerId=o.mpsId;l.Website=window.location.href;l.LoadFailJs=a;l.LoadStatus=r;l.Sendtime=(new Date).getTime();l.ProtocolType=e;l.BrowserType=I();l.ADUin=o.uin;$.ajax({type:"POST",crossDomain:true,contentType:"application/json",url:"https://mqmps.aodianyun.com:843/v1/collect/Mps_LoadStatusInfo",data:JSON.stringify(l),dataType:"json",complete:function(e){if(e.status==201){}else console.log(e.status)},success:function(e){}})};var I=function(){var e,a,r,n,l;r=navigator.userAgent;a=["Opera","Chrome","Safari","IE 6","IE 7","IE 8","IE 9","IE 10","IE 11","Firefox"];for(n=0,l=a.length;n<l;n++){e=a[n];if(r.indexOf(e)>-1){return e.replace(" ","")}}return"Other"}}function load_script(e,a){var r=document.createElement("script");r.type="text/javaScript";r.src=e;document.getElementsByTagName("head")[0].appendChild(r);if(a!=null&&a!=undefined){r.onload=a}}function flashChecker(){var e=0;var a=0;var r=0;if(r){var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(n){e=1;VSwf=n.GetVariable("$version");a=parseInt(VSwf.split(" ")[1].split(",")[0])}}else{if(navigator.plugins&&navigator.plugins.length>0){var n=navigator.plugins["Shockwave Flash"];if(n){e=1;var l=n.description.split(" ");for(var t=0;t<l.length;++t){if(isNaN(parseInt(l[t])))continue;a=parseInt(l[t])}}}}return{f:e,v:a}}